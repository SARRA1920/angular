<div class="page">
  <h1>Liste des suggestions</h1>

  <div class="toolbar">
    <button class="primary" (click)="goToForm()">Ajouter suggestion</button>
    <input
      type="search"
      placeholder="Rechercher une suggestion"
      [(ngModel)]="searchTerm"
    />
    <select [(ngModel)]="searchCategory">
      <option value="">Toutes les catégories</option>
      <option *ngFor="let cat of categories" [value]="cat">{{ cat }}</option>
    </select>
  </div>

  <ul class="suggestions">
    <li *ngFor="let suggestion of filteredSuggestions" class="suggestion">
      <div class="card-head">
        <span class="pill category">{{ suggestion.category }}</span>
        <span class="date">{{ suggestion.date | date: 'dd MMM yyyy' }}</span>
      </div>

      <h3>{{ suggestion.title }}</h3>
      <p class="desc">{{ suggestion.description }}</p>

      <div class="badges">
        <span class="pill status" [ngClass]="statusClass(suggestion)">
          {{ suggestion.status }}
        </span>
        <span class="pill likes">
          <span class="dot"></span>
          Like {{ suggestion.nbLikes || 0 }}
        </span>
      </div>

      <div class="actions">
        <button (click)="goToDetails(suggestion.id)">Détails</button>
        <button
          *ngIf="!isRefused(suggestion)"
          class="secondary"
          (click)="like(suggestion)"
        >
          Like
        </button>
        <button
          *ngIf="!isRefused(suggestion)"
          class="ghost"
          (click)="addToFavorites(suggestion)"
        >
          Ajouter aux favoris
        </button>
      </div>
    </li>
  </ul>

  <section *ngIf="favorites.length" class="favorites">
    <h3>Favoris</h3>
    <ul>
      <li *ngFor="let fav of favorites">
        {{ fav.title }} ({{ fav.category }})
      </li>
    </ul>
  </section>
</div>
